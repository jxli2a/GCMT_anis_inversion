function Ct = VTI_to_TTI(c11,c33,c44,c66,c13,theta,phi)
%% Usage: Ct = VTI_to_TTI(c11,c33,c44,c66,c13,theta,phi) is used to change
%  the VTI to TTI
%
%  Coordinate System: 1 is south, 2 is east, 3 is up
%  theta is rotation angle along 2-axis, colockwise is positive (left hand)
%  theta is with repect to the up, pointing to north.
%  phi is rotation angle along 3-axis, clockwise is positive (left hand)
%  phi is with repect to north, pointing to east.
%  By Jiaxuan Li Email: lijiaxuanmail@gmail.com
ct = cos(theta); cp = cos(phi);
st = sin(theta); sp = sin(phi);
Ct = zeros(6,6);
Ct(1,1) = c11.*(cp.^2.*ct.^2+sp.^2).^2+2.*(c13+2.*c44).*cp.^2.*(cp.^2.*ct.^2+sp.^2).* ...
  st.^2+c33.*cp.^4.*st.^4;
Ct(1,2) = (-2).*c66.*ct.^2.*(cp.^2+sp.^2).^2+c11.*(cp.^2.*ct.^2+sp.^2).*(cp.^2+ct.^2.* ...
  sp.^2)+st.^2.*(c13.*(cp.^4+2.*cp.^2.*ct.^2.*sp.^2+sp.^4)+cp.^2.*sp.^2.*(4.*c44.* ...
  ((-1)+ct.^2)+c33.*st.^2));
Ct(1,3) = ((c11+c33+(-4).*c44).*cp.^2.*ct.^2+(c11+(-2).*c66).*sp.^2).*st.^2+c13.*(ct.^2.* ...
  sp.^2+cp.^2.*(ct.^4+st.^4));
Ct(1,4) = ct.*sp.*st.*(2.*c66.*(cp.^2+sp.^2)+(-1).*(c11+(-1).*c13).*(cp.^2.*ct.^2+sp.^2)+( ...
  (-1).*c13+c33).*cp.^2.*st.^2+2.*c44.*cp.^2.*((-1)+ct.^2+(-1).*st.^2));
Ct(1,5) = (c11+(-1).*c13+(-2).*c44).*cp.*ct.*(cp.^2.*ct.^2+sp.^2).*st+(c13+(-1).*c33+2.* ...
  c44).*cp.^3.*ct.*st.^3;
Ct(1,6) = cp.*sp.*((-1).*c11.*((-1)+ct.^2).*(cp.^2.*ct.^2+sp.^2)+(-1).*(c13+2.*c44).*( ...
  cp.^2.*((-1)+2.*ct.^2)+sp.^2).*st.^2+(-1).*c33.*cp.^2.*st.^4);
Ct(2,2) = c11.*(cp.^2+ct.^2.*sp.^2).^2+2.*(c13+2.*c44).*sp.^2.*(cp.^2+ct.^2.*sp.^2).* ...
  st.^2+c33.*sp.^4.*st.^4;
Ct(2,3) = ((c11+(-2).*c66).*cp.^2+(c11+c33+(-4).*c44).*ct.^2.*sp.^2).*st.^2+c13.*(cp.^2.* ...
  ct.^2+sp.^2.*(ct.^4+st.^4));
Ct(2,4) = ((-1).*c11+c13+2.*c44).*ct.*sp.*(cp.^2+ct.^2.*sp.^2).*st+((-1).*c13+c33+(-2).* ...
  c44).*ct.*sp.^3.*st.^3;
Ct(2,5) = cp.*ct.*st.*((-2).*c66.*cp.^2+(-2).*(c66+c44.*((-1)+ct.^2)).*sp.^2+c11.*(cp.^2+ ...
  ct.^2.*sp.^2)+(-1).*(c33+(-2).*c44).*sp.^2.*st.^2+(-1).*c13.*(cp.^2+sp.^2.*(ct+( ...
  -1).*st).*(ct+st)));
Ct(2,6) = cp.*sp.*((-1).*c11.*((-1)+ct.^2).*(cp.^2+ct.^2.*sp.^2)+(-1).*(c13+2.*c44).*( ...
  cp.^2+((-1)+2.*ct.^2).*sp.^2).*st.^2+(-1).*c33.*sp.^2.*st.^4);
Ct(3,3) = c33.*ct.^4+2.*(c13+2.*c44).*ct.^2.*st.^2+c11.*st.^4;
Ct(3,4) = ((-1).*c13+c33+(-2).*c44).*ct.^3.*sp.*st+((-1).*c11+c13+2.*c44).*ct.*sp.*st.^3;
Ct(3,5) = (c13+(-1).*c33+2.*c44).*cp.*ct.^3.*st+(c11+(-1).*c13+(-2).*c44).*cp.*ct.*st.^3;
Ct(3,6) = (-1).*cp.*sp.*(((-1).*c11+2.*c66+(c11+c33+(-4).*c44).*ct.^2).*st.^2+c13.*((-1).* ...
  ct.^2+ct.^4+st.^4));
Ct(4,4) = cp.^2.*(c44.*ct.^2+c66.*st.^2)+sp.^2.*((c11+(-2).*c13+c33).*ct.^2.*st.^2+c44.*( ...
  ct.^2+(-1).*st.^2).^2);
Ct(4,5) = (-1).*cp.*sp.*(c44.*ct.^2.*((-1)+ct.^2)+(-1).*c66.*st.^2+(c11+(-2).*c13+c33+(-2) ...
  .*c44).*ct.^2.*st.^2+c44.*st.^4);
Ct(4,6) = (-1).*cp.*ct.*st.*((-1).*c66.*(cp.^2+sp.^2)+sp.^2.*((-1).*(c11+(-1).*c13).*((-1) ...
  +ct.^2)+((-1).*c13+c33).*st.^2)+c44.*(cp.^2+sp.^2.*((-1)+2.*ct.^2+(-2).*st.^2)));
Ct(5,5) = sp.^2.*(c44.*ct.^2+c66.*st.^2)+cp.^2.*((c11+(-2).*c13+c33).*ct.^2.*st.^2+c44.*( ...
  ct.^2+(-1).*st.^2).^2);
Ct(5,6) = (-1).*ct.*sp.*st.*(c44.*cp.^2+c66.*cp.^2+(-2).*c44.*cp.^2.*ct.^2+c11.*cp.^2.*(( ...
  -1)+ct.^2)+(-1).*c44.*sp.^2+c66.*sp.^2+(-1).*(c33+(-2).*c44).*cp.^2.*st.^2+c13.* ...
  cp.^2.*(1+(-1).*ct.^2+st.^2));
Ct(6,6) = c11.*cp.^2.*((-1)+ct.^2).^2.*sp.^2+c66.*ct.^2.*(cp.^2+sp.^2).^2+(c44.*cp.^4+2.* ...
  cp.^2.*((-1).*c13+(-1).*c44+(c13+2.*c44).*ct.^2).*sp.^2+c44.*sp.^4).*st.^2+c33.* ...
  cp.^2.*sp.^2.*st.^4;
for I = 1: 6 
    for J = 1: 6 
        if I > J 
            Ct(I, J) = Ct(J, I) ; 
        end
    end
end
end